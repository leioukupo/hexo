---
abbrlink: ''
categories: []
date: '2025-06-08T20:27:02.288620+08:00'
tags: []
title: title
updated: '2025-06-08T20:27:47.644+08:00'
---
# 逆向api通过外挂解锁特殊功能

很多时候逆向得到的api只能进行文本对话，不能实现最新的ai特性或者协议。比如function call功能   MCP协议  谷歌最新的a2a协议
我经过实践和尝试，提炼了一套可行的思路和代码，使得逆向api一样可以支持最新的ai相关的特性或协议(目前仅仅尝试了function call和mcp,a2a还需要了解)

## function call和Mcp的本质以及异同

### 1.function call

是llm的具体能力，专注于单个外部工具的调用生成

### 2.Mcp

一种更上层的宏观的系统设计，通常包含多个function call

### 异同

打个比方，function call是锤子，剪刀等工具，而Mcp就是说明书之类的东西，指导如何用锤子剪刀等工具制造东西
MCP负责决定在什么时候、为什么以及如何组合使用这些“动作”（包括Function Calling、内部思考、信息检索等）来达成最终目标

---



## 外挂的实现思路

fc(function call简称)或者Mcp说通俗点就是，llm根据tools参数和上下文判断要不要从上下文中提取参数执行fc或者Mcp.
不管是fc还是Mcp，最终的执行都不是说ai做的，而是ai返回一个**结构化（通常是JSON格式）的指令**，然后客户端或者别的什么端进行运算.而ai恰好就可以通过**prompt(提示词)**做到这种效果。
因为我们的思路时，在中转或者2api的服务端先过滤判断一次.
如果需要fc或者mcp，通过另外一轮ai对话提炼参数，把返回的参数加入之前的ai对话中，返回进行fc或者Mcp的运算结果.
接收到运算结果后得把结果重新编排并再进行一次对话，添加一个简单的提示词-----比如：根据上下文回答问题



> 

